<?xml version="1.0" ?>

<container xmlns="http://symfony.com/schema/dic/services"
           xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
           xsi:schemaLocation="http://symfony.com/schema/dic/services http://symfony.com/schema/dic/services/services-1.0.xsd">

    <services>
        <!-- Resource collection loaders -->

        <service id="api.mapping.resource.loader.collection" alias="api.mapping.resource.loader.collection.chain" />

        <service id="api.mapping.resource.loader.collection.chain" class="Dunglas\ApiBundle\Mapping\Resource\Loader\CollectionChainLoader" public="false" />

        <!-- Resource metadata loaders -->

        <service id="api.mapping.resource.loader.metadata" alias="api.mapping.resource.loader.metadata.chain" />

        <service id="api.mapping.resource.loader.metadata.chain" class="Dunglas\ApiBundle\Mapping\Resource\Loader\MetadataChainLoader" public="false" />

        <service id="api.mapping.resource.loader.metadata.php_doc_description_decorator" class="Dunglas\ApiBundle\Mapping\Resource\Loader\MetadataPhpDocDescriptionLoaderDecorator" decorates="api.mapping.resource.loader.metadata" public="false">
            <argument type="service" id="api.mapping.resource.loader.metadata.php_doc_description_decorator.inner" />
        </service>

        <service id="api.mapping.resource.loader.metadata.short_name_guesser_decorator" class="Dunglas\ApiBundle\Mapping\Resource\Loader\MetadataShortNameGuesserLoaderDecorator" decorates="api.mapping.resource.loader.metadata" public="false">
            <argument type="service" id="api.mapping.resource.loader.metadata.php_doc_description_decorator.inner" />
        </service>

        <!-- Property collection loaders -->

        <service id="api.mapping.property.loader.collection" alias="api.mapping.property.loader.collection.chain" />

        <service id="api.mapping.property.loader.collection.chain" class="Dunglas\ApiBundle\Mapping\Property\Loader\CollectionChainLoader" public="false" />

        <service id="api.mapping.property.loader.collection.annotation" class="Dunglas\ApiBundle\Mapping\Property\Loader\Annotation\CollectionLoader" public="false">
            <argument type="service" id="annotation_reader" />

            <tag name="api.mapping.property.loader.collection" priority="-100" />
        </service>

        <service id="api.mapping.property.loader.collection.reflection" class="Dunglas\ApiBundle\Mapping\Property\Loader\Reflection\CollectionLoader" public="false">
            <tag name="api.mapping.property.loader.collection" priority="-101" />
        </service>

        <!-- Property metadata loader -->

        <service id="api.mapping.property.loader.metadata" alias="api.mapping.property.loader.metadata.chain" />

        <service id="api.mapping.property.loader.metadata.chain" class="Dunglas\ApiBundle\Mapping\Property\Loader\MetadataChainLoader" public="false" />

        <service id="api.mapping.property.loader.metadata.annotation" class="Dunglas\ApiBundle\Mapping\Property\Loader\Annotation\MetadataLoader" public="false">
            <argument type="service" id="annotation_reader" />

            <tag name="api.mapping.property.loader.collection" priority="" />
        </service>

    </services>

</container>
